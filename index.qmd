---
title: "Iranian Diaspora Dashboard"
format:
  html:
    page-layout: full
    grid:
      sidebar-width: 0px
      margin-width: 0px
      body-width: 1500px
execute:
  echo: false
knitr:
  opts_chunk:
    fig.width: 7
    fig.height: 5
    fig.align: "center"
---

<style>
/* Import Montserrat Font */
@import url('https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap');

/* Global Font Styling */
html, body {
  font-family: "Montserrat", serif;
  margin: 0;
  padding: 0;
  height: 100%;
}

/* Header Container (non-sticky to avoid overlay issues) */
.header-container {
  background-color: #2774AE;
  width: 100%;
  box-sizing: border-box;
  position: relative;
}

/* Compact Header with Combined Navigation */
.header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 5px 20px;
  height: 50px;
  background-color: #2774AE;
  width: 100%;
  box-sizing: border-box;
}

/* Title Styling */
.header-title {
  color: white;
  font-size: 20px;
  font-weight: bold;
  text-decoration: none;
  white-space: nowrap;
}

/* Navigation Bar */
.navbar {
  border: none;
  box-shadow: none;
  margin: 0;
  padding: 0;
}

/* Main tab buttons */
.navbar .tab-button {
  border: none !important;
  background-color: #2774AE;
  color: white;
  padding: 6px 10px;
  font-size: 14px;
  cursor: pointer;
  transition: all 0.3s ease;
  margin: 0;
  border-radius: 0;
  outline: none !important;
  box-shadow: none !important;
  position: relative;
}
.navbar .tab-button.active {
  background-color: #4a8bc9;
  font-weight: bold;
}
.navbar .tab-button.active::after {
  content: "";
  position: absolute;
  bottom: 0; left: 0;
  width: 100%; height: 2px;
  background-color: white;
}
.navbar .tab-button:hover { background-color: #5fa4e0; color: white; }

/* Tab Content (hidden by default) */
.tab-content {
  display: none;
  background-color: #FAFAFA !important;
  padding: 15px 40px 40px 40px;
  text-align: center;
  font-size: 20px;
  color: #333;
  margin-top: 0;
  min-height: calc(100vh - 140px); /* keep a tall viewport for first screen */
}
.tab-content.active { display: block; }

/* Submenus (US & Canada) now in normal flow (no overlay) */
.submenu {
  position: relative;  /* was absolute; or sticky */
  width: 100%;
  background-color: #2774AE;
  padding: 1px 10px;
  z-index: 1;
  text-align: center;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
  box-sizing: border-box;
  display: none; /* hidden until parent tab is active */
  margin: 0 0 6px 0; /* add space below so content doesn't tuck under */
}
.submenu-wrapper {
  max-width: 100%;
  margin: 0 auto;
  display: flex;
  justify-content: center;
}
.sub-tab {
  border: none !important;
  background-color: #2774AE;
  color: white;
  padding: 3px 10px;
  font-size: 12px;
  cursor: pointer;
  margin: 0;
  outline: none !important;
  box-shadow: none !important;
  position: relative;
  line-height: 1.2;
}
.sub-tab.active {
  background-color: #4a8bc9;
  font-weight: bold;
}
.sub-tab.active::after {
  content: "";
  position: absolute;
  bottom: 0; left: 0;
  width: 100%; height: 2px;
  background-color: white;
}
.sub-tab:hover { background-color: #5fa4e0; color: white; }

/* sensible global default */
.tab-content iframe {
  height: 1000px !important;   /* start here; adjust as needed */
  width: 100%;
  border: none;
}

/* bump only the pages that still show an interior scroll */
#iframe-us-population,
#iframe-us-immigration {
  height: 1020px !important;   /* +60px over global */
}

#iframe-us-marriage,
#iframe-us-education,
#iframe-us-work {
  height: 1020px !important;   /* small bump */
}

#iframe-canada-population,
#iframe-canada-immigration {
  height: 1020px !important;   /* a touch shorter if they fit */
}


/* Footer */
.footer {
  display: flex; justify-content: center; align-items: center;
  background-color: #2774AE; color: white;
  padding: 5px 20px; width: 100%; height: 50px; box-sizing: border-box;
  border: none;
}

/* Responsive */
@media (max-width: 768px) {
  .header { flex-direction: column; height: auto; padding: 5px; }
  .navbar { margin-top: 5px; flex-wrap: wrap; justify-content: center; }
  .header-title { margin-bottom: 5px; }
  .footer { flex-direction: column; height: auto; padding: 10px 20px; }
}
#about.tab-content { font-size: 1em; }
</style>

```{=html}
<!-- Header Container -->
<div class="header-container">
  <div class="header">
    <a href="/" class="header-title">Iranian Diaspora Dashboard</a>
    <nav class="navbar">
      <button class="tab-button" onclick="showTab('global', this)">Global</button>
      <button class="tab-button" onclick="showTab('united-states', this)">United States</button>
      <button class="tab-button" onclick="showTab('canada', this)">Canada</button>
      <button class="tab-button" onclick="showTab('europe', this)">Europe</button>
      <button class="tab-button" onclick="showTab('bibliography', this)">Bibliography</button>
      <button class="tab-button" onclick="showTab('about', this)">About</button>
    </nav>
  </div>

  <!-- United States Submenu -->
  <div id="united-states-submenu" class="submenu">
    <div class="submenu-wrapper">
      <button class="tab-button sub-tab" data-tab="population"  onclick="showSubTab('population', this)">Defining the Population</button>
      <button class="tab-button sub-tab" data-tab="immigration" onclick="showSubTab('immigration', this)">Immigration & Citizenship</button>
      <button class="tab-button sub-tab" data-tab="marriage"    onclick="showSubTab('marriage', this)">Marriage</button>
      <button class="tab-button sub-tab" data-tab="education"   onclick="showSubTab('education', this)">Education</button>
      <button class="tab-button sub-tab" data-tab="work"        onclick="showSubTab('work', this)">Work</button>
    </div>
  </div>

  <!-- Canada Submenu -->
  <div id="canada-submenu" class="submenu">
    <div class="submenu-wrapper">
      <button class="tab-button sub-tab" data-tab="canada-population" onclick="showSubTab('canada-population', this)">Defining the Population</button>
            <button class="tab-button sub-tab" data-tab="canada-langrelig"  onclick="showSubTab('canada-langrelig', this)">Language & Religion</button>
      <button class="tab-button sub-tab" data-tab="canada-immigration" onclick="showSubTab('canada-immigration', this)">Immigration & Citizenship</button>
      <button class="tab-button sub-tab" data-tab="canada-education" onclick="showSubTab('canada-education', this)">Education</button>
                  <button class="tab-button sub-tab" data-tab="canada-work" onclick="showSubTab('canada-work', this)">Work</button>

      <button class="tab-button sub-tab" data-tab="canada-income" onclick="showSubTab('canada-income', this)">Income</button>
    </div>
  </div>
</div>
```

<!-- Global -->
<div id="global" class="tab-content">
  <iframe id="iframe-global" src="https://idd-ucla.shinyapps.io/page_6_grid_app/"></iframe>
</div>

<!-- United States sub-tabs -->
<div id="population" class="tab-content">
  <iframe id="iframe-us-population" src="https://idd-ucla.shinyapps.io/page_1_grid_app/"></iframe>
</div>

<div id="immigration" class="tab-content">
  <iframe id="iframe-us-immigration" src="https://idd-ucla.shinyapps.io/page_2_grid_app/"></iframe>
</div>

<div id="marriage" class="tab-content">
  <iframe id="iframe-us-marriage" src="https://idd-ucla.shinyapps.io/page_3_grid_app"></iframe>
</div>

<div id="education" class="tab-content">
  <iframe id="iframe-us-education" src="https://idd-ucla.shinyapps.io/page_4_grid_app/"></iframe>
</div>

<div id="work" class="tab-content">
  <iframe id="iframe-us-work" src="https://idd-ucla.shinyapps.io/page_5_grid_app/"></iframe>
</div>

<!-- Canada sub-tabs -->
<div id="canada-population" class="tab-content">
  <iframe id="iframe-canada-population" src="https://idd-ucla.shinyapps.io/canada_grid_app/"></iframe>
</div>

<div id="canada-langrelig" class="tab-content">
  <iframe id="iframe-canada-langrelig" src="https://idd-ucla.shinyapps.io/canada_page_6_grid_app/"></iframe>
</div>

<div id="canada-immigration" class="tab-content">
  <iframe id="iframe-canada-immigration" src="https://idd-ucla.shinyapps.io/canada_page_2_grid_app/"></iframe>
</div>

<div id="canada-education" class="tab-content">
  <iframe id="iframe-canada-education" src="https://idd-ucla.shinyapps.io/canada_page_3_grid_app/"></iframe>
</div>

<div id="canada-work" class="tab-content">
  <iframe id="iframe-canada-work" src="https://idd-ucla.shinyapps.io/canada_page_4_grid_app/"></iframe>
</div>

<div id="canada-income" class="tab-content">
  <iframe id="iframe-canada-income" src="https://idd-ucla.shinyapps.io/canada_page_5_grid_app/"></iframe>
</div>

<!-- Europe -->
<div id="europe" class="tab-content">
  <h2>Coming Soon</h2>
  <p>This section is under construction. Stay tuned!</p>
</div>

<!-- About -->
<div id="about" class="tab-content">
  <p>
    The Iranian Diaspora Dashboard is a part of the Iranian Diaspora project funded by 
    the Ebrahimi Program on Iranian Diaspora in Global Perspective, housed at the 
    UCLA Center for Near Eastern Studies (CNES). It was created by Roxanne Corbeil, 
    Kevan Harris, and Gilad Wenig. For any inquiries or assistance, please contact 
    <a href="mailto:cnes@international.ucla.edu">cnes@international.ucla.edu</a>.
  </p>
</div>

<!-- Bibliography -->
<div id="bibliography" class="tab-content">
  <span style="text-align:center; display:block; font-size:20px;">
    An International Bibliography of the Iranian Diaspora<br>Compiled by H.E. Chehabi and Amir Sayadabdi
  </span>
  <iframe id="iframe-bibliography" src="https://idd-ucla.shinyapps.io/idd_bib/" height="700" sandbox="allow-scripts allow-same-origin allow-forms allow-popups"></iframe>
</div>

<footer class="footer">
  <a href="https://www.international.ucla.edu/cnes/home" target="_blank" rel="noopener">
    <img src="CNES_logo.png" alt="Logo" style="height: 40px;">
  </a>
</footer>

<script>
function showTab(tabName, element) {
  document.querySelectorAll('.navbar .tab-button').forEach(btn => btn.classList.remove('active'));
  if (element) element.classList.add('active');
  document.querySelectorAll('.tab-content').forEach(tab => { tab.classList.remove('active'); tab.style.display = 'none'; });
  const selected = document.getElementById(tabName);
  if (selected) { selected.classList.add('active'); selected.style.display = 'block'; }
  const usMenu = document.getElementById('united-states-submenu');
  const caMenu = document.getElementById('canada-submenu');
  if (tabName === 'united-states') {
    if (usMenu) usMenu.style.display = 'block';
    if (caMenu) caMenu.style.display = 'none';
    const popBtnUS = document.querySelector('.sub-tab[data-tab="population"]');
    if (popBtnUS) { popBtnUS.classList.add('active'); showSubTab('population', popBtnUS); }
  } else if (tabName === 'canada') {
    if (caMenu) caMenu.style.display = 'block';
    if (usMenu) usMenu.style.display = 'none';
    const popBtnCA = document.querySelector('.sub-tab[data-tab="canada-population"]');
    if (popBtnCA) { popBtnCA.classList.add('active'); showSubTab('canada-population', popBtnCA); }
  } else {
    if (usMenu) usMenu.style.display = 'none';
    if (caMenu) caMenu.style.display = 'none';
    document.querySelectorAll('.sub-tab').forEach(st => st.classList.remove('active'));
  }
}

function showSubTab(subTabId, element) {
  document.querySelectorAll('.sub-tab').forEach(t => t.classList.remove('active'));
  if (element) element.classList.add('active');
  document.querySelectorAll('.tab-content').forEach(tab => { tab.classList.remove('active'); tab.style.display = 'none'; });
  const content = document.getElementById(subTabId);
  if (content) { content.classList.add('active'); content.style.display = 'block'; }
}

document.addEventListener('DOMContentLoaded', () => {
  const usBtn = document.querySelector('.navbar .tab-button[onclick*="united-states"]');
  showTab('united-states', usBtn);
});
</script>